<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="icon" type="image/png" href="assets/images/logo.png">
    
    <!-- TITLE -->
    <title>CamGuideMe</title>

    <!-- CSS -->
    <style>
        :root {
            --main-color: #51c3e0;
            --background: #f9f9fb;
            --card-bg: #ffffff;
            --text: #1e1e1e;
            --subtext: #555;
            --shadow: rgba(0, 0, 0, 0.1);
            --header-text: #ffffff;
            --header-hover: #D6F7FC;
            --arrow-filter: invert(1);
            --arrow-hover-filter: brightness(0) saturate(100%) invert(92%) sepia(5%) saturate(500%) hue-rotate(165deg) brightness(105%) contrast(95%);

            --visited-title-shadow: 3px 3px 4px rgba(0,0,0,0.2);
        }

        [data-theme="dark"] {
            --main-color: #3caac4;
            --background: #121212;
            --card-bg: #1e1e1e;
            --text: #f4f4f4;
            --subtext: #ccc;
            --shadow: rgba(0, 0, 0, 0.6);
            --header-text: #000000;
            --header-hover: #D6F7FC;
            --arrow-filter: invert(0);
            --arrow-hover-filter: brightness(0) saturate(100%) invert(92%) sepia(5%) saturate(500%) hue-rotate(165deg) brightness(105%) contrast(95%);

            --visited-title-shadow: 2px 2px 4px rgb(204,204,204,204);
        }

        body {
            margin: 0;
            font-family: "Poppins", Arial, sans-serif;
            background-color: var(--background);
            color: var(--text);
            transition: background-color 0.3s, color 0.3s;
        }

        /* HEADER */
        header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            background: var(--main-color);
            color: var(--header-text);
            box-shadow: 0 2px 6px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .header-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .header-content .logo {
            width: 38px;
            height: 38px;
            padding-left: 5px;
        }

        header h1 {
            font-size: 20px;
            padding-left: 5px;
            margin: 0;
            color: var(--header-text);
        }

        /* HEADER MENU */
        .header-menu {
            display: flex;
            gap: 20px;
            margin-left: auto;
        }

        .header-menu .menu-item {
            position: relative;
            color: var(--header-text);
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
            padding: 6px 10px;
            border-radius: 6px;
            transition: transform 0.2s;
            padding-bottom: 2px;
        }

        .header-menu .menu-item:hover {
            transform: scale(1.05);
            color: var(--header-hover);
        }

        @media (max-width: 600px) {
            .header-menu {
                flex-wrap: wrap;
                gap: 10px;
                width: 100%;
                justify-content: center;
                margin-top: 8px;
            }
        }

        /* DROPDOWN BUTTON */
        .menu-dropdown {
            position: relative;
        }

        .dropdown-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--header-text);
            font-size: 16px;
            font-weight: 500;
            padding: 6px 10px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* ARROW ICON */
        .arrow-icon {
            width: 14px;
            height: 14px;
            transition: transform 0.25s ease;
            filter: var(--arrow-filter);
        }

        /* Rotate arrow when active */
        .arrow-rotate {
            transform: rotate(180deg);
        }
        .menu-item:hover .arrow-icon {
            filter: var(--arrow-hover-filter);
        }

        /* DROPDOWN MENU */
        .dropdown-content {
            display: none;
            position: absolute;
            top: 28px;
            right: 10px;
            min-width: 140px;
            background: var(--card-bg);
            border: 1px solid rgba(81, 195, 224, 0.3);
            border-radius: 10px;
            box-shadow: 0 3px 10px var(--shadow);
            flex-direction: column;
            z-index: 100;
            overflow: hidden;
            padding: 0;
            box-sizing: border-box;
            animation: dropdownFade 0.25s ease;
        }

        .dropdown-content a {
            padding: 10px 14px;
            text-decoration: none;
            color: var(--text);
            display: block;
        }

        .dropdown-content a + a::before {
            content: "";
            position: absolute;
            top: 0;
            left: 12px;
            right: 12px;
            height: 1px;
            background: rgba(81, 195, 224, 0.3);
        }
        .dropdown-content a {
            position: relative;
        }
        .dropdown-content a:hover {
            background: var(--main-color);
            color: white;
            border-radius: 0;
        }
        .dropdown-content a:first-child:hover {
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }
        .dropdown-content a:last-child:hover {
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
        }

        @keyframes dropdownFade {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* PAGE TITLE */
        .favorites-title {
    text-align: center;
    font-size: 28px;
    font-weight: 700;
    color: var(--text);
    text-shadow: var(--visited-title-shadow);
    margin-top: 20px;
    margin-bottom: 10px;
}

        /* ISLAND CARDS */
        #islandContainer {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 18px;
            padding: 20px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 10px var(--shadow);
            transition: transform 0.25s ease, box-shadow 0.25s ease;
            cursor: pointer;
            position: relative;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 16px var(--shadow);
        }

        .card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .card .visited-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 23px;
            height: 23px;
            cursor: pointer;
            filter: invert(100%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(1);
            transition: transform 0.2s ease, filter 0.2s ease;
        }

        .card .visited-icon:hover {
            transform: scale(1.2);
        }

        .card .visited-icon.active {
            filter: invert(56%) sepia(84%) saturate(585%) hue-rotate(95deg) brightness(97%) contrast(92%);
        }

        .card-content {
            padding: 12px 14px;
            text-align: center;
        }

        .card-content h3 {
            margin: 6px 0;
            font-size: 18px;
            color: var(--text);
        }

        .card-content p {
            margin: 0;
            font-size: 14px;
            color: var(--subtext);
        }

        @media (max-width: 600px) {
            header {
                flex-wrap: wrap;
            }
            #islandContainer {
                grid-template-columns: 1fr;
            }
        }

        #islandContainer.linear-view .card .main-img {
            height: 400px; 
        }
    </style>
</head>

<body>
    <!-- HEADER -->
    <header>
        <div class="header-content">
            <img src="assets/images/logo.png" alt="CamGuideMe Logo" class="logo" />
            <h1>CamGuideMe</h1>
        </div>

        <!-- NAV MENU -->
        <nav class="header-menu">
            <a href="index.html" class="menu-item">Home</a>

            <div class="menu-dropdown">
                <button class="menu-item dropdown-btn">
                    Collection
                    <img src="assets/icons/arrow-downn.png" class="arrow-icon" alt="Arrow">
                </button>
                <div class="dropdown-content">
                    <a href="favorites.html">Favorites</a>
                    <a href="visited.html">Visited</a>
                </div>
            </div>

            <a href="settings.html" class="menu-item">Settings</a>
            <a href="about.html" class="menu-item">About</a>
        </nav>
    </header>

    <!-- PAGE TITLE -->
    <h1 id="favoritesTitle" class="favorites-title">VISITED</h1>

    <div id="islandContainer"></div>

    <!-- JS -->
    <script>
        // THEME FUNCTION
        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            if (theme === 'light') {
                document.documentElement.style.setProperty('--background', '#f9f9fb');
                document.documentElement.style.setProperty('--text', '#1e1e1e');
                document.documentElement.style.setProperty('--card-bg', '#ffffff');
                document.documentElement.style.setProperty('--subtext', '#555');
                document.documentElement.style.setProperty('--shadow', 'rgba(0,0,0,0.1)');
                localStorage.setItem('theme', 'light');
            } else if (theme === 'dark') {
                document.documentElement.style.setProperty('--background', '#121212');
                document.documentElement.style.setProperty('--text', '#f4f4f4');
                document.documentElement.style.setProperty('--card-bg', '#1e1e1e');
                document.documentElement.style.setProperty('--subtext', '#ccc');
                document.documentElement.style.setProperty('--shadow', 'rgba(0,0,0,0.6)');
                localStorage.setItem('theme', 'dark');
            } else if (theme === 'system') {
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    applyTheme('dark');
                } else {
                    applyTheme('light');
                }
                localStorage.setItem('theme', 'system');
            }
        }

        const savedTheme = localStorage.getItem('theme') || 'system';
        applyTheme(savedTheme);
        if (savedTheme === 'system' && window.matchMedia) {
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                applyTheme('system');
            });
        }

        // GRID & LINEAR VIEW
        const islandContainer = document.getElementById("islandContainer");
        let savedLayout = localStorage.getItem("layout") || "grid";
        let isGrid = savedLayout === "grid";

        const visited = JSON.parse(localStorage.getItem("visited")) || [];

        function setLayout() {
            if (isGrid) {
                islandContainer.style.gridTemplateColumns = "1fr 1fr 1fr";
                islandContainer.classList.remove("linear-view");
                localStorage.setItem("layout", "grid");
            } else {
                islandContainer.style.gridTemplateColumns = "1fr";
                islandContainer.classList.add("linear-view");
                localStorage.setItem("layout", "linear");
            }
        }

        // DROPDOWN MENU
        const dropdownBtn = document.querySelector(".dropdown-btn");
        const dropdownMenu = document.querySelector(".dropdown-content");
        const arrowIcon = document.querySelector(".arrow-icon");

        dropdownBtn.addEventListener("click", () => {
            const isOpen = dropdownMenu.style.display === "flex";
            dropdownMenu.style.display = isOpen ? "none" : "flex";
            if (isOpen) arrowIcon.classList.remove("arrow-rotate");
            else arrowIcon.classList.add("arrow-rotate");
        });

        document.addEventListener("click", (e) => {
            if (!e.target.closest(".menu-dropdown")) {
                dropdownMenu.style.display = "none";
                arrowIcon.classList.remove("arrow-rotate");
            }
        });

        // DISPLAY VISITED
        function displayVisited() {
            const favoritesTitle = document.getElementById("favoritesTitle");
            islandContainer.innerHTML = "";
            setLayout();

            if (visited.length === 0) {

                // Hide the title if no favorites
        favoritesTitle.style.display = "none";
        
                const emptyWrapper = document.createElement("div");
                emptyWrapper.style.gridColumn = "1 / -1";
                emptyWrapper.style.textAlign = "center";
                emptyWrapper.style.fontSize = "18px";
                emptyWrapper.style.color = "var(--subtext)";
                emptyWrapper.style.marginTop = "18%";
                emptyWrapper.textContent = "You havenâ€™t visited any islands yet.";
                islandContainer.appendChild(emptyWrapper);
                return;
            }

            // Show the title if there are favorites
    favoritesTitle.style.display = "block";

            visited.forEach(island => {
                const card = document.createElement("div");
                card.className = "card";
                card.innerHTML = `
                    <img src="${island.image}" alt="${island.name}" class="main-img">
                    <img src="assets/icons/visited.png" class="visited-icon active" alt="Visited">
                    <div class="card-content">
                        <h3>${island.name}</h3>
                        <p>${island.location}</p>
                    </div>
                `;

                const visitedIcon = card.querySelector(".visited-icon");
                visitedIcon.addEventListener("click", (e) => {
                    e.stopPropagation();
                    const idx = visited.findIndex(v => v.name === island.name);
                    if (idx > -1) {
                        visited.splice(idx, 1);
                        localStorage.setItem("visited", JSON.stringify(visited));
                        displayVisited();
                    }
                });

                card.addEventListener("click", () => {
                    localStorage.setItem("selectedIsland", JSON.stringify(island));
                    window.location.href = "island_details.html";
                });

                islandContainer.appendChild(card);
            });
        }
        displayVisited();
    </script>
</body>
</html>
