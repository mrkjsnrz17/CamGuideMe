<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- TITLE -->
    <title>CamGuideMe</title>

    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/logo.png">
    <link rel="stylesheet" href="style.css" />

    <!-- CSS -->
    <style>
        :root {
            --main-color: #51c3e0;
            --background: #f9f9fb;
            --card-bg: #ffffff;
            --text: #1e1e1e;
            --subtext: #555;
            --shadow: rgba(0,0,0,0.1);
            --icon-filter: brightness(0) invert(1);

            --header-text: #ffffff;
            --header-hover: #D6F7FC;

            --arrow-filter: invert(1);       /* white for light theme */
            --arrow-hover-filter: brightness(0) saturate(100%) invert(92%) sepia(5%) saturate(500%) hue-rotate(165deg) brightness(105%) contrast(95%); /* black on hover */
        }
        [data-theme="dark"] {
            --main-color: #3caac4;
            --background: #121212;
            --card-bg: #1e1e1e;
            --text: #f4f4f4;
            --subtext: #ccc;
            --shadow: rgba(0,0,0,0.6);
            --icon-filter: invert(0);

            --header-text: #000000;
            --header-hover: #D6F7FC;

            --arrow-filter: invert(0);       /* white for light theme */
            --arrow-hover-filter: brightness(0) saturate(100%) invert(92%) sepia(5%) saturate(500%) hue-rotate(165deg) brightness(105%) contrast(95%); /* black on hover */
        }
        body {
            margin: 0;
            font-family: "Poppins", Arial, sans-serif;
            background: var(--background);
            color: var(--text);
            transition: background-color 0.3s, color 0.3s;
        }
        /* HEADER */
header {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 16px;
    background: var(--main-color);
    color: var(--header-text);
    box-shadow: 0 2px 6px var(--shadow);
    position: sticky;
    top: 0;
    z-index: 10;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 10px;
}
.header-content .logo {
    width: 38px;
    height: 38px;
    padding-left: 5px;
}

header h1 {
    font-size: 20px;
    padding-left: 5px;
    margin: 0;
    color: var(--header-text);
}
/* HEADER MENU */
.header-menu {
    display: flex;
    gap: 20px;
    margin-left: auto; /* push menu to the right */
}

.header-menu .menu-item {
    position: relative;
    color: var(--header-text);
    text-decoration: none;
    font-size: 16px;
    font-weight: bold;
    padding: 6px 10px;
    border-radius: 6px;
    transition: transform 0.2s;
    padding-bottom: 2px;
}

.header-menu .menu-item:hover {
    transform: scale(1.05);
    color: var(--header-hover);
}

@media (max-width: 600px) {
    .header-menu {
        flex-wrap: wrap;
        gap: 10px;
        width: 100%;
        justify-content: center;
        margin-top: 8px;
    }
}
/* DROPDOWN BUTTON */
.menu-dropdown {
    position: relative;
}

.dropdown-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--header-text);
    font-size: 16px;
    font-weight: 500;
    padding: 6px 10px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 6px;
}

/* ARROW ICON */
.arrow-icon {
    width: 14px;
    height: 14px;
    transition: transform 0.25s ease;
    filter: var(--arrow-filter);
}

/* Rotate arrow when active */
.arrow-rotate {
    transform: rotate(180deg);
}
.menu-item:hover .arrow-icon {
    filter: var(--arrow-hover-filter);
}
/* DROPDOWN MENU */
.dropdown-content {
    display: none;
    position: absolute;
    top: 28px;
    right: 10px;
    min-width: 140px;
    background: var(--card-bg);
    border: 1px solid rgba(81, 195, 224, 0.3);
    border-radius: 10px;
    box-shadow: 0 3px 10px var(--shadow);
    flex-direction: column;
    z-index: 100;
    overflow: hidden;
    padding: 0;
    box-sizing: border-box;
    animation: dropdownFade 0.25s ease;
}

.dropdown-content a {
    padding: 10px 14px;
    text-decoration: none;
    color: var(--text);
    display: block;
}

/* Divider between Favorites and Visited */
.dropdown-content a + a::before {
    content: "";
    position: absolute;
    top: 0;
    left: 12px;
    right: 12px;
    height: 1px;
    background: rgba(81, 195, 224, 0.3); /* same as layout divider */
}
.dropdown-content a {
    position: relative; /* needed for the ::before positioning */
}
.dropdown-content a:hover {
    background: var(--main-color);
    color: white;
    border-radius: 0;
}
.dropdown-content a:first-child:hover {
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
}
.dropdown-content a:last-child:hover {
    border-bottom-left-radius: 10px;
    border-bottom-right-radius: 10px;
}
/* Animation */
@keyframes dropdownFade {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
}
        main {
            padding: 1rem;
        }
        .card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 10px var(--shadow);
            transition: transform 0.25s ease, box-shadow 0.25s ease;
            position: relative;
            cursor: pointer;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 16px var(--shadow);
        }
        .card img.main-img {
            width: 100%;
            height: 400px;
            object-fit: cover;
        }
        .card-content {
            padding: 12px 14px;
            text-align: center;
        }
        .card-content h3 {
            margin: 6px 0;
            font-size: 18px;
            color: var(--text);
        }
        .card-content p {
            margin: 0;
            font-size: 14px;
            color: var(--subtext);
        }
        #islandDescription {
            margin-top: 10px;
            padding: 10px;
            text-align: center;
            font-size: 14px;
            line-height: 1.5;
            color: var(--subtext);
        }
        .divider {
            margin: 12px 0;
            border: none;
            height: 1px;
            background: rgba(81, 195, 224, 0.3);
            opacity: 0.6;
        }
        .more-images {
            margin-top: 1.5rem;
        }
        .more-images h3 {
    display: flex;
    align-items: center;
    gap: 6px; /* space between icon and text */
    margin-bottom: 0.8rem;
    font-size: 16px;
    font-weight: bold;
    color: var(--text);
    padding-left: 0px;
}

.more-images .more-icon {
    width: 18px;
    height: 18px;
    padding-left: 5px;
    padding-right: 5px;
    object-fit: contain;
    filter: invert(58%) sepia(33%) saturate(1026%) hue-rotate(169deg) brightness(95%) contrast(95%);
}

        #moreImagesContainer {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: start;
            padding: 10px;
            border: 1px solid rgba(0,0,0,0.05);
            background: rgba(81, 195, 224, 0.05);
            border-radius: 15px;
        }
        #moreImagesContainer img:not(.add-icon) {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.2s ease, filter 0.2s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        #moreImagesContainer img:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .add-photo  {
            width: 120px;
            height: 120px;
            border-radius: 15px;
            background: var(--card-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border: 2px dashed var(--main-color);
            box-sizing: border-box;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            color: var(--main-color);
            transition: transform 0.2s;
        }
        .add-photo:hover {
            transform: scale(1.05);
        }
        .add-icon {
            width: 30px;
            height: 30px;
            object-fit: contain;
            transition: filter 0.2s;
            pointer-events: none;
            filter: invert(62%) sepia(83%) saturate(527%) hue-rotate(157deg) brightness(93%) contrast(90%);
        }
        .image-wrapper {
            position: relative;
            display: inline-block;
        }
        .image-wrapper img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 15px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        .image-wrapper:hover img {
            transform: scale(1.05);
        }
        .delete-icon {
            position: absolute;
            top: 3px;
            right: 3px;
            width: 25px;
            height: 25px;
            opacity: 0;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.55);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.2s ease, filter 0.2s ease;
        }
        .image-wrapper:hover .delete-icon {
            opacity: 1;
        }
        .delete-icon img {
            width: 11px !important;
            height: 11px !important;
            filter: invert(100%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(1);
            transition: filter 0.2s ease;
        }
        .delete-icon:hover {
            background: rgba(255, 0, 0, 0.75);
        }
        .delete-icon:hover img {
            filter: invert(100%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(1);
        }
    </style>
</head>

<!-- HTML -->
<body data-theme="light">

  <!-- HEADER -->
<header>
    <div class="header-content">
        <img src="assets/images/logo.png" alt="CamGuideMe Logo" class="logo" />
        <h1>CamGuideMe</h1>
    </div>

    <!-- NAV MENU -->
    <nav class="header-menu">
    <a href="index.html" class="menu-item">Home</a>

    <div class="menu-dropdown">
        <button class="menu-item dropdown-btn">
            Collection
            <img src="assets/icons/arrow-downn.png" class="arrow-icon" alt="Arrow">
        </button>
        <div class="dropdown-content">
            <a href="favorites.html">Favorites</a>
            <a href="visited.html">Visited</a>
        </div>
    </div>

    <a href="settings.html" class="menu-item">Settings</a>
    <a href="about.html" class="menu-item">About</a>
</nav>

</header>


    <!-- ISLAND DETAILS CONTENT -->
    <main>
        <div class="card">
            <img id="islandMainImg" src="" alt="Island Image" class="main-img">
            <div class="card-content">
                <h3 id="islandTitleCard">Island Name</h3>
                <p id="islandLocation">Island Location</p>
                <hr class="divider">
                <div id="islandDescription">Island Description</div>
                <hr class="divider">
                <div id="mapContainer" style="margin-top: 1rem;">
                    <h3>Location on Map</h3>
                    <iframe
                        id="mapFrame"
                        width="100%"
                        height="200"
                        style="border:0; border-radius:15px;"
                        loading="lazy"
                        allowfullscreen
                        src="">
                    </iframe>
                 </div>
            </div>
        </div>
    
        <!-- MORE IMAGES -->
        <div class="more-images">
    <h3>
        <img src="assets/icons/gallery.png" alt="More Images" class="more-icon">
        More Images
    </h3>
    <div id="moreImagesContainer">
        <!-- ADD ICON -->
        <div class="add-photo" id="addPhotoButton">
            <img src="assets/icons/add.png" alt="Add Photo" class="add-icon" />
        </div>
    </div>
</div>

    </main>

    <!-- JS -->
    <script>
        const islandTitleCard = document.getElementById("islandTitleCard");
        const islandLocation = document.getElementById("islandLocation");
        const islandMainImg = document.getElementById("islandMainImg");
        const islandDescription = document.getElementById("islandDescription");
        const moreImagesContainer = document.getElementById("moreImagesContainer");
        const mapFrame = document.getElementById("mapFrame");
        const addButton = document.getElementById("addPhotoButton");

        // ISLAND DESCRIPTION
        function setDescription(desc) {
            islandDescription.textContent = desc || "No description available.";
        }

        // THEME FUNCTION
        function applyTheme(theme) {
            if (theme === 'light') {
                document.documentElement.style.setProperty('--background', '#f9f9fb');
                document.documentElement.style.setProperty('--text', '#1e1e1e');
                document.documentElement.style.setProperty('--card-bg', '#ffffff');
                document.documentElement.style.setProperty('--subtext', '#555');
                document.documentElement.style.setProperty('--shadow', 'rgba(0,0,0,0.1)');
                document.documentElement.style.setProperty('--icon-filter', 'brightness(0) invert(1)');
                document.documentElement.style.setProperty('--title-color', '#ffffff');
                document.documentElement.style.setProperty('--header-text', '#ffffff'); // header text
                document.documentElement.style.setProperty('--arrow-filter', 'invert(1)'); // arrow color
            } else if (theme === 'dark') {
                document.documentElement.style.setProperty('--background', '#121212');
                document.documentElement.style.setProperty('--text', '#f4f4f4');
                document.documentElement.style.setProperty('--card-bg', '#1e1e1e');
                document.documentElement.style.setProperty('--subtext', '#ccc');
                document.documentElement.style.setProperty('--shadow', 'rgba(0,0,0,0.6)');
                document.documentElement.style.setProperty('--icon-filter', 'invert(0)');
                document.documentElement.style.setProperty('--title-color', '#1e1e1e');
                document.documentElement.style.setProperty('--header-text', '#000000'); // header text
                document.documentElement.style.setProperty('--arrow-filter', 'invert(0)'); // arrow color
            } else if (theme === 'system') {
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    applyTheme('dark');
                } else {
                    applyTheme('light');
                }
            }
        }

        const savedTheme = localStorage.getItem('theme') || 'system';
        applyTheme(savedTheme);
        if (savedTheme === 'system' && window.matchMedia) {
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                applyTheme('system');
            });
        }

        const selectedIsland = JSON.parse(localStorage.getItem("selectedIsland"));

        if (selectedIsland) {
            islandTitleCard.textContent = selectedIsland.name;
            islandLocation.textContent = selectedIsland.location || "";
            islandMainImg.src = selectedIsland.image;
            islandMainImg.alt = selectedIsland.name;
            setDescription(selectedIsland.description);
            
            if (selectedIsland.gallery && selectedIsland.gallery.length > 0) {
                selectedIsland.gallery.forEach(imgFile => {
                    const img = document.createElement("img");
                    const folder = selectedIsland.image.substring(0, selectedIsland.image.lastIndexOf("/") + 1);
                    img.src = folder + imgFile;
                    img.alt = selectedIsland.name;
                    moreImagesContainer.insertBefore(img, addButton);
                });
            }
            
            const query = encodeURIComponent(selectedIsland.name + ", " + selectedIsland.location);
            mapFrame.src = `https://www.google.com/maps?q=${query}&output=embed`;
        }

        // ADD / UPLOAD FUNCTION
        const uploadInput = document.createElement("input");
        uploadInput.type = "file";
        uploadInput.accept = "image/*";
        uploadInput.multiple = true;
        uploadInput.style.display = "none";
        document.body.appendChild(uploadInput);

        if (selectedIsland) {
            const islandKey = `uploadedImages_${selectedIsland.name.replace(/\s+/g, "_")}`;
            
            // DELETE 
            function createImageElement(src) {
                const wrapper = document.createElement("div");
                wrapper.className = "image-wrapper";

                const img = document.createElement("img");
                img.src = src;
                img.alt = "Uploaded Image";

                const del = document.createElement("div");
                del.className = "delete-icon";
                del.innerHTML = `<img src="assets/icons/delete.png" alt="Delete">`;

                del.addEventListener("click", () => {
                    wrapper.remove();
                    let stored = JSON.parse(localStorage.getItem(islandKey) || "[]");
                    stored = stored.filter(s => s !== src);
                    localStorage.setItem(islandKey, JSON.stringify(stored));
                });
                
                wrapper.appendChild(img);
                wrapper.appendChild(del);
                moreImagesContainer.insertBefore(wrapper, addButton);
            }
            
            // LOAD IMAGES
            const savedImages = JSON.parse(localStorage.getItem(islandKey) || "[]");
            savedImages.forEach(src => createImageElement(src));

            // UPLOAD IMAGES
            addButton.addEventListener("click", () => uploadInput.click());

            uploadInput.addEventListener("change", e => {
                const files = Array.from(e.target.files);
                const storedImages = JSON.parse(localStorage.getItem(islandKey) || "[]");

                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = evt => {
                        const src = evt.target.result;
                        storedImages.push(src);
                        localStorage.setItem(islandKey, JSON.stringify(storedImages));
                        createImageElement(src);
                    };
                    reader.readAsDataURL(file);
                });
                uploadInput.value = "";
            });
        }
    </script>
</body>
</html>